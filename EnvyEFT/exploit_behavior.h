#pragma once

#include "vuln_driver.h"

namespace kernel
{
	//This class defines the type of exploitable behavior that a particular 
	class exploit_behavior
	{
		friend class vulnerable_driver;
	public:
		exploit_behavior(vulnerable_driver* owner) : _vuln_driver(owner) {}
		virtual uint64_t allocate_kernel_pool(uint64_t address, size_t size, POOL_TYPE pool_type) = 0;
		virtual void free_kernel_pool(uint64_t address) = 0;

	protected:
		vulnerable_driver* _vuln_driver; //Store a pointer to our vulnerable driver
	};
}